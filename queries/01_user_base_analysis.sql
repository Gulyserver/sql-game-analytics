-- Базовый анализ пользовательской базы
-- Исследуем портрет пользователей на предмет уникальности, повторных регистраций и динамики базы

-- 1. Общее количество пользователей и уникальных ID
select count (*) as cnt
       , count (id_user) as cnt_users
       , count(distinct id_user) as cnt_unique_users
from skygame.users
-- Вывод: 3078 уникальных пользователей

-- 2. Пользователи, регистрировавшиеся более одного раза
select id_user
       , count (reg_date) as cnt_reg_date
from skygame.users
group by id_user
having count (reg_date) > 1
-- Вывод:
-- 15 пользователей регистрировались повторно:
--   • 11 — по 2 раза
--   • 4 — по 4 раза

-- 3. Минимальная и максимальная дата регистрации
select min(reg_date)
        , max (reg_date)
from skygame.users
-- Вывод: Регистрация происходила с июля 2022 по апрель 2023

-- 4. Пользователи без даты регистрации
select *
from skygame.users
where reg_date is null
-- Вывод: Пользователи с неопределённой датой регистрации отсутствуют

-- 5. Динамика пользовательской базы по месяцам
select date_trunc ('month', reg_date) as reg_date_trunc
        , count (distinct id_user) as cnt_unique_users
from skygame.users
where reg_date < '2023-04-01'  -- апрель исключаем: месяц неполный
group by reg_date_trunc
order by reg_date_trunc
-- Вывод: Наблюдается рост количества регистраций с января 2023 года.

-- Финальный вывод:
-- Zombie Revolution имеет 3078 уникальных пользователей, зарегистрированных в период с июля 2022 по март 2023.
-- Апрель исключён из анализа как неполный месяц.
-- Повторные регистрации имеются у 15 пользователей. 
-- С начала 2023 года наблюдается ускорение роста пользовательской базы.


